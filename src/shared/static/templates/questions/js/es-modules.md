# ❓ Как работают ES Modules (ESM) в JavaScript?

---

## Основные принципы ES Modules

- **Статическая структура:**  
  - Импорты и экспорты объявляются на верхнем уровне, что позволяет браузеру/сборщику определить зависимости до выполнения кода.  
  - Это обеспечивает оптимизации, такие как tree shaking.

- **Область видимости:**  
  - Модули имеют собственную область видимости.  
  - Переменные и функции внутри модуля не видны глобально, если явно не экспортированы.

- **Импорт и экспорт:**  
  - `export` — экспортирует переменные, функции, классы из модуля.  
  - `import` — импортирует их в другой модуль.

---

## Пример

```js
// math.js
export function sum(a, b) {
  return a + b;
}
export const PI = 3.14;

// app.js
import { sum, PI } from './math.js';
console.log(sum(2, 3)); // 5
console.log(PI); // 3.14
```

---

## Особенности работы

- **Загрузка модулей:**

  - В браузере модули загружаются с помощью `<script type="module" src="...">`.
  - Модули загружаются асинхронно и выполняются в строгом режиме (`'use strict'`).

- **Динамический импорт:**

  - Синтаксис `import('./module.js')` возвращает Promise с загруженным модулем.
  - Позволяет ленивую загрузку и код-сплиттинг.

- **Импорт по ссылке:**

  - Импортируемые сущности — ссылки на оригинальные объекты, а не копии.
  - Изменения в экспорте отражаются в импортах.

- **Однократное исполнение:**

  - Модуль исполняется один раз, даже если импортирован в нескольких местах.

---

## Итог

ES Modules — современный стандарт модульности в JS с явной структурой, статическим анализом и поддержкой ленивой загрузки. Они улучшают управление зависимостями, изоляцию кода и оптимизацию сборки.

---

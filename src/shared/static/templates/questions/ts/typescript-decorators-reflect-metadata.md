# ❓ Как декораторы взаимодействуют с метаданными (Reflect Metadata) в TypeScript?

---

## Reflect Metadata API

- Это стандартный API для работы с метаданными, реализованный в библиотеке `reflect-metadata`.  
- Позволяет сохранять, читать и управлять дополнительной информацией (метаданными) о классах, методах, свойствах и параметрах.

---

## Основные методы

- `Reflect.defineMetadata(metadataKey, metadataValue, target, propertyKey?)` — сохраняет метаданные.  
- `Reflect.getMetadata(metadataKey, target, propertyKey?)` — получает метаданные.  
- Метаданные ассоциируются с объектом или его членом.

---

## Взаимодействие с декораторами

- Декораторы часто используют Reflect Metadata для хранения дополнительной информации о классах и их элементах без изменения их структуры.  
- Например, параметр типа метода или инъекция зависимостей.

---

## Пример использования

```ts
import "reflect-metadata";

function LogType(target: any, propertyKey: string) {
  const type = Reflect.getMetadata("design:type", target, propertyKey);
  console.log(`${propertyKey} type: ${type.name}`);
}

class Demo {
  @LogType
  public name: string;

  @LogType
  public age: number;
}
```

- При применении декоратора `LogType` мы получаем тип свойства через метаданные и логируем его.

---

## Особенности

- TypeScript автоматически генерирует некоторые метаданные типов при компиляции, если включены флаги компилятора:

  ```json
  "emitDecoratorMetadata": true,
  "experimentalDecorators": true
  ```

* Это позволяет декораторам автоматически получать информацию о типах параметров, возвращаемом типе и типах свойств.

---

## Применение в фреймворках

- Angular, NestJS и другие фреймворки используют Reflect Metadata для реализации Dependency Injection, валидации, сериализации и других механизмов, основанных на метапрограммировании.

---

## Итог

Декораторы и Reflect Metadata совместно дают мощный механизм для аннотирования и расширения классов, позволяя сохранять и извлекать информацию о типах и других данных во время выполнения без изменения исходного кода.

---
